\begin{figure}[H]
\centering
\begin{class}{ActiveShop(id: \integer)}
\ 
\\chan\ ex\_switch,in\_switch: nil | in\_talk
\ 
\\chan\ ex\_talk,in\_talk:\integer \times \integer
\ 
\\chan\ done\_ex\_talk,done\_in\_talk
\ \\ \
\\ActiveShop\_PI = 
\\ \qquad ex\_talk(y, z).in\_talk<y,z>
\\ \ \qquad \qquad \qquad .done\_in\_talk().done\_ex\_talk<>.ActiveShop\_PI 
\\ \qquad + \ in\_switch(x).ex\_switch<x,ex\_talk>.IdleShop\_PI
\\\begin{state}
self, vmId, message: \integer
\\transferableOperation: nil | in\_talk
\end{state} 
\\
\begin{init}
\\self = id
\\transferableOperation = in\_talk
\end{init} 
\\
\begin{op}{in\_switch\_\_\_\_\ then\ IdleShop}
x!: nil | talk
\ST
x! = transferableOperation
\\transferableOperation' = nil
\end{op}
\\
\begin{op}{in\_talk}
\Delta (vmId, message)
\\y?, z?: \integer
\ST
y? = message'
\\z? = vmId'
\end{op}
\end{class}
\caption{$\pi$-OZ specification of the $ActiveShop$ using non-atomic reaction.}
\label{comp_oz_pi_statefull_activeShop_non_atomic}
\end{figure}